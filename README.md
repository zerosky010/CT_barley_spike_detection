# CT_detection_barley_spike_python

Detection and characterization of spike architecture based on deep learning and X-ray computed tomography Image segmentation in barley.
## Scripts
All codes were written by python.

**Scripts/U-net_prediction.py** : A high-throughput pipeline of CT image processing with UNet-based segmentation pipeline.

**Scripts/Extraction.py** : Extraction of barley spike morphological features.

**Scripts/requirements.txt** : Authors' python environments.

## origin_nii
original X-ray CT images datasets of barley varieties

<table width="218" border="0" cellpadding="0" cellspacing="0" style="width:163.50pt;border-collapse:collapse;table-layout:fixed;">
   <colgroup><col width="72" style="width:54.00pt;">
   <col width="146" style="mso-width-source:userset;mso-width-alt:4672;">
   </colgroup><tbody><tr height="18" style="height:13.50pt;">
    <td class="xl65" height="18" width="72" style="height:13.50pt;width:54.00pt;" x:str="">ID</td>
    <td class="xl65" width="146" style="width:109.50pt;" x:str="">Barley varieties</td>
   </tr>
   <tr height="18" style="height:13.50pt;">
    <td class="xl66" height="18" style="height:13.50pt;" x:num="">1635</td>
    <td class="xl66" x:str="">IG38794</td>
   </tr>
   <tr height="18" style="height:13.50pt;">
    <td class="xl66" height="18" style="height:13.50pt;" x:num="">1644</td>
    <td class="xl66" x:str="">IG38679</td>
   </tr>
   <tr height="18" style="height:13.50pt;">
    <td class="xl66" height="18" style="height:13.50pt;" x:num="">1677</td>
    <td class="xl66" x:str="">KENIA</td>
   </tr>
   <tr height="18" style="height:13.50pt;">
    <td class="xl66" height="18" style="height:13.50pt;" x:num="">1678</td>
    <td class="xl66" x:str="">PROCTOR</td>
   </tr>
   <tr height="18" style="height:13.50pt;">
    <td class="xl66" height="18" style="height:13.50pt;" x:num="">1679</td>
    <td class="xl66" x:str="">BEKA</td>
   </tr>
   <tr height="18" style="height:13.50pt;">
    <td class="xl66" height="18" style="height:13.50pt;" x:num="">1682</td>
    <td class="xl66" x:str="">Diamant</td>
   </tr>
   <tr height="18" style="height:13.50pt;">
    <td class="xl66" height="18" style="height:13.50pt;" x:num="">1683</td>
    <td class="xl66" x:str="">EU optic</td>
   </tr>
   <tr height="18" style="height:13.50pt;">
    <td class="xl66" height="18" style="height:13.50pt;" x:num="">1685</td>
    <td class="xl66" x:str="">EU Annabel</td>
   </tr>
   <tr height="18" style="height:13.50pt;">
    <td class="xl66" height="18" style="height:13.50pt;" x:num="">1686</td>
    <td class="xl66" x:str="">Alexis</td>
   </tr>
   <tr height="18" style="height:13.50pt;">
    <td class="xl66" height="18" style="height:13.50pt;" x:num="">1721</td>
    <td class="xl66" x:str="">s28829</td>
   </tr>
   <tr height="19" style="height:14.25pt;">
    <td class="xl67" height="19" style="height:14.25pt;" x:num="">1765</td>
    <td class="xl67" x:str="">s25897</td>
   </tr>
    <tr height="19" style="height:14.25pt;">
    <td class="xl67" height="19" style="height:14.25pt;" x:num="">1725</td>
    <td class="xl67" x:str="">s128172</td>
   </tr>
   <!--[if supportMisalignedColumns]-->
   <!--[endif]-->
  </tbody></table>

## model_training

UNet training datasets


## predicted_nii

UNet predicted results



## results_pcd & results_virtual spikes

Extraction pipeline results

# How to cite
Ling, Y., Zhao, Q., Liu, W. et al. Detection and characterization of spike architecture based on deep learning and X-ray computed tomography in barley. Plant Methods 19, 115 (2023). <a herf=https://doi.org/10.1186/s13007-023-01096-w>10.1186/s13007-023-01096-w</a>
